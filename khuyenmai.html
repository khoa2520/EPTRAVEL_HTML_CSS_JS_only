<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPTRAVEL_KHUYENMAI</title>
    <!-- Chèn font -->
    <link rel="stylesheet" href="asset/css/font.css">
    <link rel="stylesheet" href="asset/css/color.css">
    <link rel="stylesheet" href="asset/css/text_style.css">
    <link rel="stylesheet" href="asset/css/background.css">
    <link rel="stylesheet" href="./asset/css/khuyenmai.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css">
    <script src="asset/javascrip/header.js"></script>
    <!-- Favicon :  title off website -->
    <link rel="shortcut icon" href="asset/favicon/titlelogo.png">
    <!-- Thư viện w3.js -->
    <script src="https://www.w3schools.com/lib/w3.js"></script>
    <script src="asset/javascrip/formatnumber.js"></script>

    <script src="./asset/javascrip/responsivekhuyenmai.js"></script>
    <script>
        function goThongTin(matour) {
            window.location.href = "detail.html?matour=" + matour;
        }
    </script>
    <!-- Link css -->

    <!--  backtop1 -->
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" />
    <link rel="stylesheet" href="asset/css/backtop.css">

</head>

<body>
    <div class="container">
        <!--load header -->
        <div w3-include-html="header.html"></div>
        <div class="khuyenmai-content">
            <!-- Bỏ nội dung vô đây -->
            <div class="khuyenmai_tittle">
                <!-- image slider start -->
                <div class="kmslider">
                    <div class="kmslides">
                        <!-- radio button start -->
                        <input type="radio" name="radio-btn" id="kmradio1">
                        <input type="radio" name="radio-btn" id="kmradio2">
                        <input type="radio" name="radio-btn" id="kmradio3">
                        <!-- radio button end -->
                        <!-- slide image start -->
                        <div class="km_slide km_first">
                            <img src="./asset/images/khuyenmai/baner-giam-gia-tour-du-lich_113653707.jpg" alt="">
                        </div>
                        <div class="km_slide ">
                            <img src="./asset/images/khuyenmai/tour-phu-quoc_1.jpg" alt="">
                        </div>
                        <div class="km_slide ">
                            <img src="./asset/images/khuyenmai/banner du lịch 2_-13-03-2019-11-41-11.png" alt="">
                        </div>
                        <!-- slide image end -->
                        <!-- automatic navigation start -->
                        <div class="km_navigation-auto">
                            <div class="km_auto-btn1"></div>
                            <div class="km_auto-btn2"></div>
                            <div class="km_auto-btn3"></div>
                        </div>
                        <!-- automatic navigation end -->
                    </div>
                    <!-- manual navigation start -->
                    <div class="km_navigation-manual">
                        <label for="kmradio1" class="km_manual-btn"></label>
                        <label for="kmradio2" class="km_manual-btn"></label>
                        <label for="kmradio3" class="km_manual-btn"></label>
                    </div>
                    <!-- manual navigation end -->
                </div>
                <!-- image slider end -->
                <script type="text/javascript">
                    var counter = 1;
                    setInterval(function () {
                        document.getElementById('kmradio' + counter).checked = true;
                        counter++;
                        if (counter > 3) {
                            counter = 1;
                        }
                    }, 5000);
                </script>
            </div>

            <div class="khuyenmai_tittle1">
                <div class="khuyenmai_tour--item">
                    <div class="home--title--item">TOUR TRONG NƯỚC</div>
                </div>
                <a class="khuyenmai_tour--show" href="./chitietkhuyenmai.html">Xem tất cả</a>
            </div>
            <div id="khuyenmai_category_trongnuoc"></div>
            <div class="khuyenmai_tittle1">
                <div class="khuyenmai_tour--item">
                    <div class="home--title--item">TOUR QUỐC TẾ</div>
                </div>
                <a class="khuyenmai_tour--show" href="./chitietkhuyenmai.html">Xem tất cả</a>
            </div>
            <div id="khuyenmai_category_nuocngoai"></div>
        </div>

        <!-- load footer -->
        <div w3-include-html="footer.html"></div>

    </div>
    <script>
        var xmlhttp = new XMLHttpRequest();
        var url = "../asset/data/tour.json";

        xmlhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                var myArr = JSON.parse(this.responseText);
                myFunction(myArr);
            }
        }
        xmlhttp.open("GET", url, true); // Ra lệnh chứ chưa thực hiện
        xmlhttp.send(); //Thực hiên thực sự

        function goThongtin(id) {
                window.location.href = 'thongtin.html?matour=' + id;
        }
        function goChiTiet(id) {
            window.location.href = 'chitiettour.html?matour=' + id;
        }

        function myFunction(arr) {
            var div1 = "<div class='khuyenmai_row'>";
            var div2 = "<div class='khuyenmai_row'>";

            var i;

            for (i = 0; i < arr.length; i++) {
                var x = arr[i].giatiennguoilon;
                var y = arr[i].giamgia;
                var z = x - (x * (y / 100));
                if (arr[i].quocgia == "Tour du lịch trong nước" && arr[i].khuyenmai == "Nổi bật") {
                    div1 += "<div class='khuyenmai_sp'><div class='khuyenmai_item--img'><a href='chitiettour.html?matour=" + arr[i].ma_tour + "'><img class='khuyenmai_img' src='" + arr[i].images[1] + "'></a><label onclick='goChiTiet(" + '"' + arr[i].ma_tour + '"' + ")' class='khuyenmai_lbl--chitiet'>Xem Chi Tiết </label></div> <div class='khuyenmai_sp--content'><h3 class='khuyenmai_text'>" + arr[i].ten_tour + "</h3><p class='khuyenmai_matour'>Mã tour: " + "<span>" + arr[i].ma_tour + "</span>" + "</p><p class='khuyenmai_time'>Thời gian: " + arr[i].thoigian + "</p><p class='khuyenmai_diadiem'>Địa điểm khởi hành: " + arr[i].noikhoihanh + "</p><div class='khuyenmai_gia'>" + formatNumber(z) + "<span>đ</span></div><div class='khuyenmai_giacu'>" + formatNumber(arr[i].giatiennguoilon) + "<span>đ</span></div><input type='button' onclick='goThongtin(" + '"' + arr[i].ma_tour + '"' + ")' class='khuyenmai_imagecard' value='Đặt ngay'><img class='phuongtien_item1' src='./asset/images/ICON/bus.png' alt='bus'><img class='phuongtien_item2' src='./asset/images/ICON/plane.png' alt='plane'><div class='khuyenmai_percent'><img class='khuyenmai_percent--tag' src='./asset/images/ICON/tag.png'><div class='khuyenmai_percent--text' >-<span>" + arr[i].giamgia + "</span><span>%</span></div></div><input type='button' class='khuyenmai_button_yeuthich' value='Thêm vào yêu thích' onclick='themyeuthich_km(this)' ></div></div>"
                } else if (arr[i].quocgia == "Tour du lịch nước ngoài" && arr[i].khuyenmai == "Nổi bật") {
                    div2 += "<div class='khuyenmai_sp'><div class='khuyenmai_item--img'><a href='chitiettour.html?matour=" + arr[i].ma_tour + "'><img class='khuyenmai_img' src='" + arr[i].images[1] + "'></a><label onclick='goChiTiet(" + '"' + arr[i].ma_tour + '"' + ")' class='khuyenmai_lbl--chitiet'>Xem Chi Tiết </label></div><div class='khuyenmai_sp--content'><h3 class='khuyenmai_text'>" + arr[i].ten_tour + "</h3><p class='khuyenmai_matour'>Mã tour: " + "<span>" + arr[i].ma_tour + "</span>" + "</p><p class='khuyenmai_time'>Thời gian: " + arr[i].thoigian + "</p><p class='khuyenmai_diadiem'> Địa điểm khởi hành: " + arr[i].noikhoihanh + "</p><div class='khuyenmai_gia'>" + formatNumber(z) + "<span>đ</span></div><div class='khuyenmai_giacu'>" + formatNumber(arr[i].giatiennguoilon) + "<span>đ</span></div><input type='button' onclick='goThongtin(" + '"' + arr[i].ma_tour + '"' + ")' class='khuyenmai_imagecard' value='Đặt ngay'><img class='phuongtien_item1' src='./asset/images/ICON/bus.png' alt='bus'><img class='phuongtien_item2' src='./asset/images/ICON/plane.png' alt='plane'><div class='khuyenmai_percent'><img class='khuyenmai_percent--tag' src='./asset/images/ICON/tag.png'><div  class='khuyenmai_percent--text' >-<span>" + arr[i].giamgia + "</span><span>%</span></div></div><input type='button' class='khuyenmai_button_yeuthich' value='Thêm vào yêu thích' onclick='themyeuthich_km(this)'></div></div>"
                }
            }
            div1 += "</div>";
            div2 += "</div>";
            document.getElementById("khuyenmai_category_trongnuoc").innerHTML = div1;
            document.getElementById("khuyenmai_category_nuocngoai").innerHTML = div2;
        }

        w3.includeHTML();
    </script>
    <!--Search-->
    <script src="./asset/javascrip/search.js"></script>

    <!--  backtop2 -->
    <div id="backtop">
        <i class="fas fa-chevron-up"></i>
    </div>

    <!--   Thêm vào yêu thích từ khuyến mãi -->
    <script src="./asset/javascrip/yeuthich.js"></script>
    <script>
        // var yeuthich = new Array();
        function themyeuthich_km(x) {

            if (localStorage.getItem("User_login") === null) {
                alert("Cần phải đăng nhập trước khi thêm vào Yêu Thích");
                document.getElementById("modal__container").style.display = "flex";
            } else {
                //Lấy ID bằng click  -> DOM
                var id = x.parentElement.children[1].children[0].innerText;
                //alert(id);
                var yt = new Array(id);
                var title = x.parentElement.children[0].innerText; //Lấy title
                for (var i = 0; i < yeuthich.length; i++) {
                    if (yeuthich[i][0] == id) {
                        return alert("Tour" + title + " đã có sẵn trong danh mục yêu thích");
                    }
                }
                yeuthich.push(yt);
                alert(title + " đã được thêm vào yêu thích");

                //Lưu giỏ hàng
                sessionStorage.setItem("yeuthich", JSON.stringify(yeuthich));
            }
        }
    </script>

</body>
<!-- backtop3 -->
<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
<script src="./asset/javascrip/backtop.js">
</script>
<script src="./asset/javascrip/search.js"></script>
<script src="./asset/javascrip/dangnhap.js"></script>
<script src="./asset/javascrip/onload_avar.js"></script>

</html>